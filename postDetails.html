<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- inmport bootstrap -->
    <script src="./node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="node_modules/axios/dist/axios.min.js"></script>
    <script src="./node_modules/jquery/dist/jquery.min.js"></script>
    <link
      rel="stylesheet"
      href="./node_modules/bootstrap/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />
    <link rel="stylesheet" href="conta.css" />
  </head>
  <style>
    body {
      background-color: #0e1136 !important;
    }
  </style>
  <body>
    <!-- button add -->
    <div
      class="material-symbols-outlined bg-light"
      id="AddPost"
      style="
        z-index: 1;
        position: fixed;
        right: 5%;
        bottom: 5%;
        height: 60px;
        width: 60px;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        box-shadow: 0 10px 10px rgba(0, 0, 0, 0.3);
        background-color: #9096e5 !important;
      "
      data-bs-toggle="modal"
      data-bs-target="#addpost"
    >
      <h1
        style="
          display: flex;
          justify-content: center;
          align-items: center;
          font-size: 50px;
        "
      >
        add
      </h1>
    </div>

    <!-- modals start -->

    <div
      class="modal fade"
      id="exampleModal"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Login</h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label
                  for="recipient-name"
                  class="col-form-label"
                  type="username"
                  >Username:</label
                >
                <input type="text" class="form-control" id="username-input" />
              </div>
              <div class="mb-3">
                <label for="message-text" class="col-form-label" type="Password"
                  >Password:</label
                >
                <input type="password" class="form-control" id="pass-input" />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="loginBtnClicked"
              onclick="loginBtnClricked()"
            >
              Login
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- modals end -->

    <!-- model for register -->

    <div
      class="modal fade"
      id="modalContactForm"
      tabindex="-1"
      role="dialog"
      aria-labelledby="myModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header text-center">
            <h4 class="modal-title w-100 font-weight-bold">Register</h4>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
              id="closseBtnClicked"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body mx-3">
            <div class="md-form mb-5">
              <!-- <i class="fas fa-user prefix grey-text"></i> -->
              <label data-error="wrong" data-success="right" for="form34">
                name</label
              >
              <input
                type="name"
                class="form-control validate"
                id="name-input-r"
              />
            </div>
            <div class="md-form mb-5">
              <!-- <i class="fas fa-user prefix grey-text"></i> -->
              <label data-error="wrong" data-success="right" for="form34"
                >User name</label
              >
              <input
                type="name"
                class="form-control validate"
                id="user-name-input-r"
              />
              <label
                data-error="wrong"
                data-success="right"
                for="form29"
                style="font-size: 15px; justify-content: start; display: flex"
                >profile
              </label>

              <input
                type="File"
                class="form-control validate"
                style="height: 50px"
                id="img-profile-input"
              />
            </div>

            <div class="md-form mb-5">
              <!-- <i class="fas fa-envelope prefix grey-text"></i> -->
              <label data-error="wrong" data-success="right" for="form29">
                email</label
              >
              <input
                type="email"
                class="form-control validate"
                id="email-input-r"
              />
            </div>

            <div class="md-form mb-5">
              <i class="fas fa-envelope prefix grey-text"></i>
              <label data-error="wrong" data-success="right" for="form29">
                Password</label
              >
              <input
                type="password"
                class="form-control validate"
                id="passwprd-input-r"
              />
            </div>

            <div class="md-form mb-5">
              <i class="fas fa-envelope prefix grey-text"></i>
              <label data-error="wrong" data-success="right" for="form29">
                Confirm Password</label
              >
              <input type="password" class="form-control validate" />
            </div>
          </div>
          <div class="modal-footer d-flex justify-content-center">
            <button
              class="btn btn-unique"
              id="SendBtnClicked"
              onclick="loginBtnClrricked()"
            >
              Register <i class="fas fa-paper-plane-o ml-1"></i>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- start modal for add post -->

    <!-- Modal -->
    <div
      class="modal fade modal-fullscreen-sm-down"
      id="addpost"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">New Post</h1>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <label
              data-error="wrong"
              data-success="right"
              for="form29"
              style="font-size: 20px; justify-content: center; display: flex"
            >
              Title</label
            >
            <input
              type="title"
              class="form-control validate"
              style="height: 50px"
              id="title-post-input"
            />
            <label
              data-error="wrong"
              data-success="right"
              for="form29"
              style="font-size: 15px; justify-content: start; display: flex"
              >Body
            </label>
            <textarea
              class="form-control"
              placeholder="Leave a comment here"
              id="post-body-input"
              style="resize: none"
            ></textarea>
            <label
              data-error="wrong"
              data-success="right"
              for="form29"
              style="font-size: 15px; justify-content: start; display: flex"
              >image
            </label>
            <input
              type="File"
              class="form-control validate"
              style="height: 50px"
              id="img-post-input"
            />
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button type="button" class="btn btn-primary" id="creat-post">
              Create
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- end modal for modal -->

    <div class="container pt-1" style="height: 100px">
      <div class="d-flex justify-content-center">
        <div class="col-12">
          <nav
            class="navbar navbar-expand-lg navbar-light bg-light shadow rounded"
            style="background-color: #9096e5 !important"
          >
            <div class="container-fluid">
              <a class="navbar-brand" href="/Home.html">Xionion</a>
              <a class="navbar-brand" href="#">Profile</a>

              <button
                class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent"
                aria-expanded="false"
                aria-label="Toggle navigation"
              >
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                  <li class="nav-item">
                    <a
                      class="nav-link active"
                      aria-current="page"
                      href="#"
                      style="font-size: 24px"
                      >Home</a
                    >
                  </li>
                </ul>
                <div class="d-flex">
                  <button
                    class="btn btn btn-outline-dark"
                    type="button"
                    id="Register-btn"
                    data-bs-toggle="modal"
                    data-bs-target="#modalContactForm"
                  >
                    Register
                  </button>
                  <button
                    style="background-color: #0e1136; color: #9096e5"
                    type="button"
                    class="btn mx-2"
                    data-bs-toggle="modal"
                    data-bs-target="#exampleModal"
                    data-bs-whatever="@mdo"
                    id="login-btn"
                  >
                    Login
                  </button>
                  <div
                    class=""
                    style="display: none; justify-content: center; left: 200px"
                    id="Logout-btn"
                  >
                    <b
                      id="nav-username"
                      style="
                        display: flex;
                        align-items: center;
                        left: -150px;
                        justify-content: center;
                        padding: 15px;
                      "
                    >
                      @rtuor
                    </b>
                    <img
                      src=""
                      id="image-profile"
                      alt=""
                      style="border-radius: 50%"
                      height="50px"
                      width="40px"
                    />
                    <button
                      type="button"
                      class="btn btn-primary-success mx-2"
                      onclick="logout()"
                    >
                      Logout
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </nav>
        </div>
        <!-- Content here -->
      </div>
    </div>

    <!-- mine content -->

    <div class="container" style="height: 1000px">
      <div class="d-flex justify-content-around mt-5">
        <h1
          style="
            background-color: #9096e5;
            border: 5px solid #9096e5;
            border-radius: 7px;
          "
        >
          @ <span id="userNameSpan"> maohamd </span>
        </h1>
        <h1
          style="
            background-color: #9096e5;
            border: 5px solid #9096e5;
            border-radius: 7px;
            margin-right: 300px;
          "
        >
          Post
        </h1>
      </div>
      <div id="postContentt">
        <!-- <div
          class="card shadow d-flex justify-content-center"
          style="height: 550px !important; width: 700px !important"
        >
          <div class="card-header">
            <img
              src="./img/1200px-Google_Material_Design_Logo.svg.png"
              alt=""
              class="rounded-circle border border-2"
              width="40px"
              height="40px "
              id="profile_image"
            />
            <span> <b id="name"> 8hudi</b></span>
          </div>
          <div class="card-body">
            <img src="./img/تنزيل (1).jpg" alt="" class="w-100" />
            <h6
              style="color: rgb(146, 145, 145); font-size: smaller"
              class="mt-1"
            >
              2 min ago
            </h6>
            <h5>hello huyt</h5>
            <p style="font-size: 15px">
              Lorem ipsum dolor sit amet consectetur adipisicing elit. Quia,
              blanditiis. Ullam quo unde placeat cumque fugit tenetur nihil,
              pariatur voluptatibus nobis alias. Iste, unde molestias sit
              recusandae quia doloribus quam?
            </p>
            <hr />
            <div class="">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                class="bi bi-chat-left-text"
                viewBox="0 0 16 16"
              >
                <path
                  d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"
                />
                <path
                  d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6m0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"
                />
              </svg>
              <span> (3) comment </span>
            </div>
          </div>
        </div> -->
        <!--comment  -->
        <div class="" id="comments">
          <!-- <div
            class="p-3"
            style="background-color: #9096e5; border-radius: 7px"
          >
              user + user nam  
            <div class="">
              <img
                src="/img/images.png"
                alt=""
                class="rounded-circle"
                style="width: 40px; height: 40px"
              />
              <b>@moham</b>
               comment body 
              <div class="">
                Lorem ipsum dolor, sit amet consectetur adipisicing elit.
                Deserunt delectus natus consequuntur perferendis animi quisquam
                commodi eligendi, similique laboriosam sed rerum labore
                asperiores exercitationem adipisci! Molestias eligendi quas iste
                aliquid?
              </div>
                comment body  
            </div>
              user + user nam -->
        </div>

        <!-- comments end -->
      </div>

      <div class="p-3" style="background-color: #9096e5; border-radius: 7px">
        <div class="">
          <input
            type="text"
            style="width: 90%"
            placeholder="Comment"
            id="CommentAdd-div"
          />
          <button
            type="button"
            onclick="createCommentClicked()"
            class="btn btn-light"
          >
            Send
          </button>
        </div>
      </div>
    </div>
  </body>
  <script src="/index.js"></script>

  <script>
    // console.log(window.location.search);
    const urlParams = new URLSearchParams(window.location.search);

    const id = urlParams.get("postId");

    ////////////////////////////////////////////////////////////

    function GETPOST() {
      axios.get(`${baseUrl}/posts/${id}`).then((response) => {
        const post = response.data.data;
        const comments = post.comments;
        const author = post.author;
        document.getElementById("userNameSpan").innerHTML = author.username;
        let commentsContent = ``;
        for (comment of comments) {
          commentsContent += `
              <div
                        class="p-3"
                        style="background-color: #9096e5; border-radius: 7px"
                      >
                        <!-- user + user nam -->
                        <div class="">
                          <img
                            src="${comment.author.profile_image}"
                            alt=""
                            class="rounded-circle"
                            style="width: 40px; height: 40px"
                          />
                          <b> ${comment.author.username}</b>
                          <!-- comment body -->
                          <div class=""> 
                            ${comment.body}
                          </div>
                          <!-- comment body -->
                        </div>
                        <!-- user + user nam -->
                      </div>
              `;
        }

        // document.getElementById("posts").innerHTML = " "
        const postcontant = ` <div
        class="card shadow d-flex justify-content-center"
        style="height: 550px !important; width: 700px !important"
      >
        <div class="card-header">
          <img
            src="${author.profile_image}"
            alt=""
            class="rounded-circle border border-2"
            width="40px"
            height="40px "
            id="profile_image"
          />
          <span> <b id="name"> ${author.name}</b></span>
        </div>
        <div class="card-body">
          <img src="${post.image}" alt="" class="w-100" />
          <h6
            style="color: rgb(146, 145, 145); font-size: smaller"
            class="mt-1"
          >
           ${post.created_at}
          </h6>
          <h5 >${post.title}</h5>
          <p style="font-size: 15px">
            ${post.body}
          </p>
          <hr />
          <div class="">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-chat-left-text"
              viewBox="0 0 16 16"
            >
              <path
                d="M14 1a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H4.414A2 2 0 0 0 3 11.586l-2 2V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12.793a.5.5 0 0 0 .854.353l2.853-2.853A1 1 0 0 1 4.414 12H14a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"
              />
              <path
                d="M3 3.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5M3 6a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9A.5.5 0 0 1 3 6m0 2.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5"
              />
            </svg>
            <span> (${post.comments_count}) comment </span>
          </div>
        </div>
         
      </div> 
      <div class="" id="comments">
        ${commentsContent}
        </div>`;

        document.getElementById("postContentt").innerHTML = postcontant;
      });
    }

    function createCommentClicked() {
      let commentBody = document.getElementById("CommentAdd-div").value;
      let params = {
        body: commentBody,
      };
      let token = localStorage.getItem("token");
      let url = `${baseUrl}/posts/${id}/comments`;
      let headersO = {
        headers: {
          authorization: `Bearer ${token}`,
        },
      };
      axios.post(url, params, headersO).then((response) => {
        console.log(response);

        GETPOST();
        document.getElementById("CommentAdd-div").value = " ";
      });
    }

    GETPOST();
  </script>
</html>
